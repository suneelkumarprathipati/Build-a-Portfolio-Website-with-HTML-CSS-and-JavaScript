<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My 3D Roller Portfolio</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: Arial, sans-serif; }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; left: 20px; color: white; z-index: 10; }
        #ui h1 { margin: 0; font-size: 2em; }
        #ui p { margin: 5px 0; }
        #add-form { position: absolute; bottom: 20px; right: 20px; background: rgba(0,0,0,0.8); padding: 20px; border-radius: 10px; color: white; max-width: 300px; }
        #add-form input, #add-form button { display: block; width: 100%; margin: 10px 0; padding: 10px; border-radius: 5px; border: none; }
        #add-form button { background: #ff6b6b; color: white; cursor: pointer; }
        #add-form button:hover { background: #d63031; }
        @media (max-width: 768px) { #ui { font-size: 0.8em; } #add-form { bottom: 10px; right: 10px; max-width: 250px; } }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <div id="ui">
        <h1>My 3D Roller Portfolio</h1>
        <p>Use mouse to orbit. Click objects to interact. Arrow keys for keyboard control.</p>
    </div>
    <div id="add-form">
        <label for="title">Title:</label>
        <input type="text" id="title" required aria-label="Item title">
        <label for="file">Upload Image or Doc:</label>
        <input type="file" id="file" accept="image/*,.pdf" required aria-label="Upload file">
        <button type="submit" id="add-btn">Add Item</button>
    </div>
    <script>
        // Scene, Camera, Renderer
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight);

        // Room (Walls, Floor)
        const roomGeometry = new THREE.BoxGeometry(10, 10, 10);
        const roomMaterial = new THREE.MeshLambertMaterial({ color: 0x8e44ad, side: THREE.BackSide });
        const room = new THREE.Mesh(roomGeometry, roomMaterial);
        scene.add(room);

        const floorGeometry = new THREE.PlaneGeometry(10, 10);
        const floorMaterial = new THREE.MeshLambertMaterial({ color: 0x2c3e50 });
        const floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -Math.PI / 2;
        floor.position.y = -5;
        scene.add(floor);

        // Desk
        const deskGeometry = new THREE.BoxGeometry(3, 0.5, 2);
        const deskMaterial = new THREE.MeshLambertMaterial({ color: 0x34495e });
        const desk = new THREE.Mesh(deskGeometry, deskMaterial);
        desk.position.set(0, -4, 0);
        scene.add(desk);

        // Computer (Clickable)
        const computerGeometry = new THREE.BoxGeometry(1, 0.5, 0.5);
        const computerMaterial = new THREE.MeshLambertMaterial({ color: 0xe74c3c });
        const computer = new THREE.Mesh(computerGeometry, computerMaterial);
        computer.position.set(0, -3.5, 0);
        computer.userData = { type: 'link', url: 'https://example.com' }; // Example link
        scene.add(computer);

        // Portfolio Items (Dynamic)
        const items = JSON.parse(localStorage.getItem('portfolioItems') || '[]');
        items.forEach((item, index) => {
            const geometry = new THREE.PlaneGeometry(1, 1);
            const material = new THREE.MeshLambertMaterial({ map: new THREE.TextureLoader().load(item.data) });
            const mesh = new THREE.Mesh(geometry, material);
            mesh.position.set(index * 1.5 - 2, -3, -2);
            mesh.userData = { type: 'item', index };
            scene.add(mesh);
        });

        // Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        camera.position.set(0, 0, 5);

        // Raycaster for Clicks
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        window.addEventListener('click', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(scene.children);
            if (intersects.length > 0) {
                const obj = intersects[0].object;
                if (obj.userData.type === 'link') window.open(obj.userData.url);
                else if (obj.userData.type === 'item') removeItem(obj.userData.index);
            }
        });

        // Keyboard Controls
        window.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'ArrowUp': camera.position.z -= 0.1; break;
                case 'ArrowDown': camera.position.z += 0.1; break;
                case 'ArrowLeft': camera.position.x -= 0.1; break;
                case 'ArrowRight': camera.position.x += 0.1; break;
            }
        });

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Add Item
        document.getElementById('add-btn').addEventListener('click', () => {
            const title = document.getElementById('title').value;
            const file = document.getElementById('file').files[0];
            if (file && title) {
                const reader = new FileReader();
                reader.onload = () => {
                    const items = JSON.parse(localStorage.getItem('portfolioItems') || '[]');
                    items.push({ title, data: reader.result });
                    localStorage.setItem('portfolioItems', JSON.stringify(items));
                    location.reload(); // Reload to update scene
                };
                reader.readAsDataURL(file);
            }
        });

        // Remove Item
        function removeItem(index) {
            const items = JSON.parse(localStorage.getItem('portfolioItems') || '[]');
            items.splice(index, 1);
            localStorage.setItem('portfolioItems', JSON.stringify(items));
            location.reload();
        }
    </script>
</body>
</html>
